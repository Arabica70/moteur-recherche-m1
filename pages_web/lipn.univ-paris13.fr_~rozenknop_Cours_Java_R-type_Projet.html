<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2015-11-23 lun. 21:16 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title></title>
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. Objectif du projet</a></li>
<li><a href="#orgheadline2">2. Moyens</a></li>
<li><a href="#orgheadline3">3. Structuration du code</a></li>
<li><a href="#orgheadline4">4. Multiplication</a></li>
<li><a href="#orgheadline5">5. Paysage</a></li>
<li><a href="#orgheadline6">6. Ennemis</a></li>
<li><a href="#orgheadline10">7. Implémentation</a>
<ul>
<li><a href="#orgheadline7">7.1. héritage</a></li>
<li><a href="#orgheadline8">7.2. conteneurs</a></li>
<li><a href="#orgheadline9">7.3. Polymorphisme</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> Objectif du projet</h2>
<div class="outline-text-2" id="text-1">
<p>
Vous devrez réaliser un jeu de type « shoot-them-up à scrolling horizontal ». Un exemple
connu de ce type de jeu est R-type (je vous invite à y jeter un œil sur YouTube, par exemple ici :
<a href="http://youtu.be/L5071LIgVgU">http://youtu.be/L5071LIgVgU</a>).
</p>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-2">
<h2 id="orgheadline2"><span class="section-number-2">2</span> Moyens</h2>
<div class="outline-text-2" id="text-2">
<p>
Pour ce faire, vous partirez du code du troisième programme vu dans le TP 1 :
<a href="../TP1/sujet/Projet%20JAVA%20-%20S%C3%A9ance%201.html">(lien vers le TP1)</a>
qui affiche une image d'avion à l'écran et permet de la
manipuler à l'aide de touches du clavier (déplacement et rotation).
</p>

<ul class="org-ul">
<li><p>
<b>Orientation de l'avion</b>
</p>

<p>
Commencez par modifier l'orientation initiale de l'avion : il doit
avoir l'avant tourné vers la droite de l'écran.
</p></li>

<li><p>
<b>Modifier les déplacements</b>
</p>

<p>
Modifiez le code pour supprimer la possibilité de faire tourner
l'avion sur lui-même.
</p>

<p>
Choisissez quatre touches du clavier et faites en sorte que
chacune commande une direction de déplacement de l'avion (haut,
bas, droite, gauche).
</p>

<p>
Empêchez l'avion de sortir de l'écran !
</p></li>

<li><p>
<b>Agressivité !</b>
</p>

<p>
Ajoutez la possibilité de tirer une roquette avec la touche
<i>Espace</i> (une seule roquette à la fois 
dans un premier temps). Pour cela, ajoutez les variables
<i>roqX</i> et <i>roqY</i> à la classe <i>JeuBasique</i>, et stockez-y les
coordonnées de la roquette, lorsqu'elle a été tirée. Pour indiquer
qu'aucune roquette n'a été tirée (ou lorsque la précédente est
sortie de l'écran), vous pouvez par exemple stocker des valeurs
négatives dans ces deux variables.
</p></li>

<li><p>
<b>Météorite</b>
</p>

<p>
Ajoutez une météorite, qui se déplace vers la gauche.
</p></li>

<li><p>
<b>Collisions</b>
</p>

<p>
Détectez lorsqu'une roquette rencontre la météorite (auquel cas
celle-ci disparaît) et lorsque la météorite rencontre l'avion
(auquel cas le jeu s'arrête).
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-2">
<h2 id="orgheadline3"><span class="section-number-2">3</span> Structuration du code</h2>
<div class="outline-text-2" id="text-3">
<p>
En principe, votre code doit commencer à devenir assez grand et
illisible, car les méthodes <i>render</i> et <i>update</i> de la classe
<i>JeuBasique</i> gèrent tous les objets du jeu et leurs différents
comportements, et cette classe contient plein d'attributs (au moins
deux pour chaque objet : ses coordonnées).
</p>

<p>
Comme le projet va encore grossir, il est temps de changer cela !
Une bonne idée serait de créer une classe pour chaque type d'objet,
qui contiendrait tous ses attributs (par exemple ses coordonnées, ou
l'image qui lui est associée), ainsi que les méthodes <i>update</i> et
<i>render</i>.
</p>

<p>
Prenons pour exemple la roquette. On peut implanter le fichier
<i>Roquette.java</i> suivant :
</p>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.*;

<span style="color: #1c86ee;">public</span> <span style="color: #1c86ee;">class</span> <span style="color: #00688b;">Roquette</span>
{
    <span style="color: #00688b;">float</span> <span style="color: #2e8b57;">x</span>;
    <span style="color: #00688b;">float</span> <span style="color: #2e8b57;">y</span>;
    <span style="color: #00688b;">Image</span> <span style="color: #2e8b57;">image</span> = <span style="color: #6e8b3d;">null</span> ;

    <span style="color: #1c86ee;">public</span> <span style="color: #cd9b1d;">Roquette</span>(<span style="color: #00688b;">float</span> <span style="color: #2e8b57;">x</span>, <span style="color: #00688b;">float</span> <span style="color: #2e8b57;">y</span>) {
        image = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Image</span>(<span style="color: #8b7355;">"data/roquette.png"</span>);
        <span style="color: #1c86ee;">this</span>.x = x;
        <span style="color: #1c86ee;">this</span>.y = y;
    }

    <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">update</span>(<span style="color: #00688b;">GameContainer</span> <span style="color: #2e8b57;">gc</span>, <span style="color: #00688b;">int</span> <span style="color: #2e8b57;">delta</span>)
        <span style="color: #1c86ee;">throws</span> <span style="color: #00688b;">SlickException</span>
    {
        <span style="color: #7f7f7f;">/* </span><span style="color: #7f7f7f;">ici va le code qui modifie les valeurs de x et de y en fonction de delta */</span>
        <span style="color: #7f7f7f;">/* </span><span style="color: #7f7f7f;">(delta &#233;tant le temps pass&#233; depuis le dernier appel &#224; cette m&#233;thode) */</span>
    }

    <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">render</span>(<span style="color: #00688b;">GameContainer</span> <span style="color: #2e8b57;">gc</span>, <span style="color: #00688b;">Graphics</span> <span style="color: #2e8b57;">g</span>)
            <span style="color: #1c86ee;">throws</span> <span style="color: #00688b;">SlickException</span>
    {
        image.draw(x,<span style="color: #00688b;">y</span>) ;
    }
}
</pre>
</div>

<p>
On peut ensuite modifier la classe <i>JeuBasique</i> ainsi :
</p>
<ul class="org-ul">
<li>on remplace les champs <i>roqX</i> et <i>roqY</i> par un seul champ :</li>
</ul>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #00688b;">Roquette</span> <span style="color: #2e8b57;">roq</span> = <span style="color: #6e8b3d;">null</span> ;
</pre>
</div>

<ul class="org-ul">
<li>dans la méthode <i>update</i>, on remplace les calculs de <i>roqX</i> et
<i>roqY</i> par l'appel suivant :</li>
</ul>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #1c86ee;">if</span> (roq != <span style="color: #6e8b3d;">null</span>) roq.update(container, delta);
</pre>
</div>
<p>
Remarquez qu'il faut tester si la roquette existe avant d'appeler sa
méthode <i>update</i>. En revanche, on n'a plus besoin de tester si ses
coordonnées sont positives (avec la convention maintenant obsolète
que des coordonnées négatives indiquent qu'il n'y a pas de
roquette en jeu).
</p>

<ul class="org-ul">
<li><p>
dans la méthode <i>render</i>, on remplace l'affichage de la roquette
par :
</p>
<div class="org-src-container">

<pre class="src src-java"><span style="color: #1c86ee;">if</span> (roq!=<span style="color: #6e8b3d;">null</span>) roq.render(container, g);
</pre>
</div></li>

<li><p>
lorque la touche <i>espace</i> est utilisée, il faut créer la
roquette :
</p>
<div class="org-src-container">

<pre class="src src-java">roq = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Roquette</span>(mobile_X, mobile_Y);
</pre>
</div></li>

<li><p>
enfin, quand elle sort de l'écran ou rencontre une météorite, il
faut la détruire :
</p>
<div class="org-src-container">

<pre class="src src-java">roq = <span style="color: #6e8b3d;">null</span>;
</pre>
</div></li>
</ul>


<p>
Créez ainsi des classes pour les trois types d'objets que vous
avez utilisés, de manière à alléger le code de la classe
<i>JeuBasique</i>.
</p>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">4</span> Multiplication</h2>
<div class="outline-text-2" id="text-4">
<p>
Faites en sorte que plusieurs roquettes puissent être simultanément
présentes à l'écran. Pour cela, vous devrez créer un tableau de
<i>Roquette</i>. Lorsque la touche espace est utilisée, le programme crée
une nouvelle roquette à la première position de ce tableau qui vaut
<i>null</i>. Lorsqu'une roquette sort de l'écran, sa position dans le
tableau redevient <i>null</i>.
</p>

<p>
Utilisez ensuite le paramètre <i>delta</i> de <i>JeuBasique.update</i>
pour imposer un délai entre deux tirs de roquette.
</p>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">5</span> Paysage</h2>
<div class="outline-text-2" id="text-5">
<p>
Faites défiler le paysage !
</p>
</div>
</div>

<div id="outline-container-orgheadline6" class="outline-2">
<h2 id="orgheadline6"><span class="section-number-2">6</span> Ennemis</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>Créez des ennemis mouvants, en plus des météorites.</li>
<li>Créez des ennemis qui tirent des projectiles</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline10" class="outline-2">
<h2 id="orgheadline10"><span class="section-number-2">7</span> Implémentation</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7"><span class="section-number-3">7.1</span> héritage</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Vous avez plusieurs types d'objets en mouvement dans ce jeu :
vaisseau du joueur, ennemis, missiles. Tous partagent certaines
propriétés et certains comportements.
</p>

<p>
Par exemple:
</p>
<ul class="org-ul">
<li><span class="underline">propriétés communes</span> : ils ont tous
une position et une vitesse.</li>
<li><span class="underline">comportement commun</span> : le calcul d'une
nouvelle position est toujours le même et ne dépend que de
l'ancienne position, de la vitesse et du temps écoulé.</li>
</ul>

<p>
En utilisant l'héritage, hiérarchisez vos classes de manière à
regrouper les propriétés et les méthodes communes dans des classes
parentes.
</p>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8"><span class="section-number-3">7.2</span> conteneurs</h3>
<div class="outline-text-3" id="text-7-2">
<p>
Plutôt que d'utiliser des tableaux pour stocker les différents
objets, utilisez des <i>conteneurs</i>. Lorsqu'un
objet est créé, il faut l'ajouter au conteneur
correspondant. Lorsqu'il est détruit, il faut le retirer du
conteneur correspondant.
</p>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-3">
<h3 id="orgheadline9"><span class="section-number-3">7.3</span> Polymorphisme</h3>
<div class="outline-text-3" id="text-7-3">
<p>
Utilisez les conteneurs et l'héritage pour factoriser au maximum
votre code.
Voici un exemple d'une classe <code>JeuPlusTropBasique</code>, qui utilise à la fois
les conteneurs et l'héritage :
</p>
<ul class="org-ul">
<li>les conteneurs sont de type <code>java.util.Vector</code></li>
<li>toutes les classes d'objets en mouvement héritent d'une classe
nommée <code>Mobile</code></li>
<li><b>tous les objets présents à l'écran sont stockés dans un même
conteneur</b>, nommé <code>mobiles</code></li>
<li>remarquez comme le code des méthodes <i>update</i> et <i>render</i> se
simplifie du fait que tous les objets mobiles héritent de la
classe <code>Mobile</code> et peuvent être référencés depuis le même
conteneur.</li>
<li>notez que dans cet exemple, on passe <i>this</i> aux méthodes <i>calcul</i>
     des mobiles. 
<ul class="org-ul">
<li>Cela permet aux mobiles d'agir sur l'objet
<code>JeuPlusTropBasique</code> en appelant ses méthodes <i>addMobile</i> et
<i>removeMobile</i> (par exemple, lorsque le vaisseau tire une
roquette, il appelle la méthode <i>addMobile</i> de l'objet
<code>JeuPlusTropBasique</code> de manière à inscrire la nouvelle roquette
dans la liste des objets à animer);</li>
<li>Cela permet également aux méthodes <i>calcul</i> des mobiles
d'accéder aux conteneurs <i>rochers</i> et <i>mobiles</i> du jeu, de
manière à détecter les collisions.</li>
</ul></li>
</ul>

<div class="org-src-container">

<pre class="src src-java"><span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">AppGameContainer</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">BasicGame</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">GameContainer</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">Graphics</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">Image</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">Input</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">org</span>.<span style="color: #6e8b3d;">newdawn</span>.<span style="color: #6e8b3d;">slick</span>.<span style="color: #00688b;">SlickException</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #6e8b3d;">java</span>.<span style="color: #6e8b3d;">util</span>.<span style="color: #00688b;">Vector</span>;
<span style="color: #1c86ee;">import</span> <span style="color: #00688b;">Mobile</span>;

<span style="color: #1c86ee;">public</span> <span style="color: #1c86ee;">class</span> <span style="color: #00688b;">JeuPlusTropBasique</span>  <span style="color: #1c86ee;">extends</span> <span style="color: #00688b;">BasicGame</span> {
        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Exemple d'un objet d&#233;plac&#233; par un "joueur"</span>
<span style="color: #cd853f;">         *</span>
<span style="color: #cd853f;">         * </span><span style="color: #6e8b3d;">@author</span><span style="color: #cd853f;"> Antoine Rozenknop</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #cd853f;">/** joueur */</span>
        <span style="color: #1c86ee;">private</span> <span style="color: #00688b;">VaisseauJoueur</span> <span style="color: #2e8b57;">vaisseau_joueur</span> = <span style="color: #6e8b3d;">null</span>;

        <span style="color: #cd853f;">/** Position du papier peint */</span>
        <span style="color: #1c86ee;">private</span> <span style="color: #00688b;">float</span> <span style="color: #2e8b57;">ciel_X</span> = 0;
        <span style="color: #1c86ee;">private</span> <span style="color: #00688b;">float</span> <span style="color: #2e8b57;">ciel_flipped_X</span> = 0;

        <span style="color: #cd853f;">/** Images */</span>
        <span style="color: #1c86ee;">private</span> <span style="color: #00688b;">Image</span> <span style="color: #2e8b57;">ciel_image</span>;
        <span style="color: #1c86ee;">private</span> <span style="color: #00688b;">Image</span> <span style="color: #2e8b57;">ciel_image_flipped</span>;

        <span style="color: #cd853f;">/** Liste des mobiles */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">Vector</span>&lt;<span style="color: #00688b;">Mobile</span>&gt; <span style="color: #2e8b57;">mobiles</span>;
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">Vector</span>&lt;<span style="color: #00688b;">Mobile</span>&gt; <span style="color: #2e8b57;">new_mobiles</span>;
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">Vector</span>&lt;<span style="color: #00688b;">Mobile</span>&gt; <span style="color: #2e8b57;">deleted_mobiles</span>;

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Construction de l'objet JeuBasique</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #cd9b1d;">JeuPlusTropBasique</span>() {
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">appel au constructeur de la classe parente : BasicGame</span>
                <span style="color: #1c86ee;">super</span>(<span style="color: #8b7355;">"Jeu basique"</span>);
        }

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Initialisation du jeu</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">init</span>(<span style="color: #00688b;">GameContainer</span> <span style="color: #2e8b57;">container</span>) <span style="color: #1c86ee;">throws</span> <span style="color: #00688b;">SlickException</span> {
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">On demande au conteneur d'essayer d'afficher 100 images par secondes</span>
                container.setTargetFrameRate(100);
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">On demande au conteneur d'afficher le nombre d'images par secondes r&#233;el</span>
                container.setShowFPS(<span style="color: #6e8b3d;">true</span>);
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">Affichage en plein &#233;cran</span>
                container.setFullscreen(<span style="color: #6e8b3d;">true</span>);

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">On charge les images depuis le disque</span>
                ciel_image = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Image</span>(<span style="color: #8b7355;">"ressources/land.png"</span>);
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">On redimensionne le papier peint &#224; la taille de la fen&#234;tre</span>
                ciel_image = ciel_image.getScaledCopy(container.getWidth(), container.getHeight());
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">Et on en cr&#233;e une copie retourn&#233;e verticalement</span>
                ciel_image_flipped = ciel_image.getFlippedCopy(<span style="color: #6e8b3d;">true</span>, <span style="color: #6e8b3d;">false</span>);
                ciel_flipped_X = ciel_image.getWidth() ;

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">Ajout des mobiles</span>
                mobiles = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Vector</span>&lt;<span style="color: #00688b;">Mobile</span>&gt;();
                new_mobiles = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Vector</span>&lt;<span style="color: #00688b;">Mobile</span>&gt;();
                deleted_mobiles = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Vector</span>&lt;<span style="color: #00688b;">Mobile</span>&gt;();
                vaisseau_joueur = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">VaisseauJoueur</span>(container.getWidth()/2, container.getHeight()/2, 0, 0, 0, 0, 1);
                mobiles.add(vaisseau_joueur);
                mobiles.add(<span style="color: #1c86ee;">new</span> <span style="color: #00688b;">Asteroide2267</span>(400, 400, 20, 20, (<span style="color: #00688b;">float</span>)<span style="color: #6e8b3d;">Math</span>.PI/4, 2f, 1));
        }

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Affichage du jeu</span>
<span style="color: #cd853f;">         * La m&#233;thode render est appel&#233;e r&#233;guli&#232;rement par le framework Slick</span>
<span style="color: #cd853f;">         * Elle re&#231;oit automatiquement deux param&#232;tres : le "container" (qui repr&#233;sente la fen&#234;tre</span>
<span style="color: #cd853f;">         * dans laquelle le jeu appara&#238;t), et un "contexte graphique" qui repr&#233;sente la surface &#224; l'int&#233;rieur</span>
<span style="color: #cd853f;">         * de cette fen&#234;tre. C'est ce contexte graphique que l'on utilise pour tracer les objets.</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">render</span>(<span style="color: #00688b;">GameContainer</span> <span style="color: #2e8b57;">container</span>, <span style="color: #00688b;">Graphics</span> <span style="color: #2e8b57;">g</span>) {
                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">affichage du papier peint</span>
                g.drawImage(ciel_image, ciel_X, 0);
                g.drawImage(ciel_image_flipped, ciel_flipped_X, 0);

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">affichage des mobiles</span>
                <span style="color: #1c86ee;">for</span> (<span style="color: #00688b;">Mobile</span> <span style="color: #2e8b57;">m</span> : mobiles) m.affiche(container, g);
        }

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Mise-&#224;-jour des &#233;l&#233;ments du jeu</span>
<span style="color: #cd853f;">         * La m&#233;thode update est appel&#233;e r&#233;guli&#232;rement par le framework Slick (avant chaque appel</span>
<span style="color: #cd853f;">         * &#224; la m&#233;thode render).</span>
<span style="color: #cd853f;">         * Elle re&#231;oit automatiquement deux param&#232;tres : le "container" (qui repr&#233;sente la fen&#234;tre</span>
<span style="color: #cd853f;">         * dans laquelle le jeu appara&#238;t), et un "delta". Ce "delta" repr&#233;sente le nombre de millisecondes</span>
<span style="color: #cd853f;">         * qui se sont &#233;coul&#233;es depuis la derni&#232;re mise-&#224;-jour.</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">update</span>(<span style="color: #00688b;">GameContainer</span> <span style="color: #2e8b57;">container</span>, <span style="color: #00688b;">int</span> <span style="color: #2e8b57;">delta</span>) {

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">calcul du delta en secondes</span>
                <span style="color: #00688b;">float</span> <span style="color: #2e8b57;">delta_sec</span> = delta * 0.001f;

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">d&#233;placement du fond d'&#233;cran, &#224; une vitesse de 130 pixels par seconde vers la gauche</span>
                ciel_X = ciel_X - 130 * delta_sec;
                <span style="color: #1c86ee;">if</span> (ciel_X &lt; -ciel_image.getWidth()) ciel_X = ciel_flipped_X + ciel_image_flipped.getWidth() ;
                ciel_flipped_X = ciel_flipped_X - 130 * delta_sec;
                <span style="color: #1c86ee;">if</span> (ciel_flipped_X &lt; -ciel_image_flipped.getWidth()) ciel_flipped_X = ciel_X + ciel_image.getWidth() ;

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">d&#233;placement des mobiles</span>
                <span style="color: #1c86ee;">for</span> (<span style="color: #00688b;">Mobile</span> <span style="color: #2e8b57;">m</span> : mobiles)
                        <span style="color: #1c86ee;">if</span> (!<span style="color: #1c86ee;">this</span>.deleted_mobiles.contains(m) ) 
                                m.calcul(container, delta_sec, <span style="color: #1c86ee;">this</span>);

                <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">mise-&#224;-jour des listes</span>
                addNewMobiles();
                removeDestroyedMobiles();
        }

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Une autre fa&#231;on de rep&#233;rer lorsqu'une touche est enfonc&#233;e : la m&#233;thode keyPressed</span>
<span style="color: #cd853f;">         * appel&#233;e automatiquement par Slick &#224; chaque touche enfonc&#233;e</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">keyPressed</span>(<span style="color: #00688b;">int</span> <span style="color: #2e8b57;">key</span>, <span style="color: #00688b;">char</span> <span style="color: #2e8b57;">c</span>) {
                <span style="color: #1c86ee;">if</span> (key == <span style="color: #6e8b3d;">Input</span>.KEY_ESCAPE) {
                        System.exit(0);
                }
        }

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * keyReleased est appel&#233;e automatiquement par Slick &#224; chaque touche rel&#226;ch&#233;e</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">keyReleased</span>(<span style="color: #00688b;">int</span> <span style="color: #2e8b57;">key</span>, <span style="color: #00688b;">char</span> <span style="color: #2e8b57;">c</span>) {
                <span style="color: #1c86ee;">if</span> (key == <span style="color: #6e8b3d;">Input</span>.KEY_F1) {
                }
        }


        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * ajout de mobile</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">addMobile</span>(<span style="color: #00688b;">Mobile</span> <span style="color: #2e8b57;">m</span>) {
                new_mobiles.add(m);
        }

        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">removeMobile</span>(<span style="color: #00688b;">Mobile</span> <span style="color: #2e8b57;">m</span>) {
                deleted_mobiles.add(m);
        }

        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">addNewMobiles</span>()
        {
                mobiles.addAll(new_mobiles);
                new_mobiles.clear();
        }
        <span style="color: #1c86ee;">public</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">removeDestroyedMobiles</span>()
        {
                mobiles.removeAll(deleted_mobiles);
                deleted_mobiles.clear();
        }

        <span style="color: #cd853f;">/**</span>
<span style="color: #cd853f;">         * Point d'entr&#233;e du programme</span>
<span style="color: #cd853f;">         * </span>
<span style="color: #cd853f;">         * </span><span style="color: #6e8b3d;">@param</span><span style="color: #cd853f;"> argv Les arguments pass&#233;s en ligne de commande</span>
<span style="color: #cd853f;">         */</span>
        <span style="color: #1c86ee;">public</span> <span style="color: #1c86ee;">static</span> <span style="color: #00688b;">void</span> <span style="color: #cd9b1d;">main</span>(<span style="color: #00688b;">String</span>[] <span style="color: #2e8b57;">argv</span>) {
                <span style="color: #1c86ee;">try</span> {
                        <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">Cr&#233;ation d'un JeuBasique</span>
                        <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">Puis cr&#233;ation d'une fen&#234;tre de jeu (AppGameContainer) &#224; laquelle on associe le JeuBasique</span>
                        <span style="color: #00688b;">AppGameContainer</span> <span style="color: #2e8b57;">container</span> = <span style="color: #1c86ee;">new</span> <span style="color: #00688b;">AppGameContainer</span>(<span style="color: #1c86ee;">new</span> <span style="color: #00688b;">JeuPlusTropBasique</span>());
                        <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">Taille de la fen&#234;tre</span>
                        container.setDisplayMode(container.getScreenWidth(),container.getScreenHeight(),<span style="color: #6e8b3d;">false</span>);
                        <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">D&#233;marrage du jeu contenu dans la fen&#234;tre</span>
                        container.start();


                } <span style="color: #7f7f7f;">// </span><span style="color: #7f7f7f;">gestion des erreurs</span>
                <span style="color: #1c86ee;">catch</span> (<span style="color: #00688b;">SlickException</span> <span style="color: #2e8b57;">e</span>) {
                        e.printStackTrace();
                }
        }
}
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2015-11-23 lun. 21:16</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
